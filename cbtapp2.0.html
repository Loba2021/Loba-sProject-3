<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="bootstrap.min.css">
    <script src="../js/jquery.min.js"></script>
</head>
<body >
    <div class="card w-50 text-center">
        
    </div>
    <div style="position: relative; top: 100px; text-align: center;" id="showscore2" ><h1 id="showscore"></h1></div>

    <main style="display:flex; justify-content: center; padding-top: 150px; width: 100%;">
        <div class="card w-50 text-center p-3" style="align-items: center;">
            <h1> <span id="head"></span> CBT Test</h1>

            <div class="card p-2" id="ForCandidate">
                <input type="name" id="CandName" placeholder="Kindly Enter Your Name" onkeyup="showgetat()">
            <button class="btn btn-outline-success mt-2" onclick="Enter()" id="getat">Enter</button>
            </div>


            <div id="disp2"></div>  
            <div id="disp"></div>
            <div class="w-50 d-flex justify-content-between" id="nextprev">
                <button class="btn btn-outline-danger" onclick="control('prev')"><</button>
                <button class="btn btn-outline-danger"onclick="control('next')" id="nextbtn">></button>
            </div>
            <div class="d-flex justify-content-around w-100 mt-2" id="maindisapear">
                <button onclick="submit()" class="btn btn-success w-25">Submit</button>
                <div id="disapear2"><button onclick="retake()" class="btn btn-secondary">Retake</button></div>
                <div id="disapear"><button onclick="start()" class="btn btn-primary">Start</button></div>
            </div>
        </div>
    </main>


    <!-- <input type="text" class="mybox" value="1">
    <input type="text" class="mybox" value="2">
    <input type="text" class="mybox" value="3">
    <input type="text" class="mybox" value="4"> -->
    <script src="../js/popper.min.js"></script>
    <script src="../js/latestcompiled.min.js"></script>
</body>
</html>
<script>
    getat.hidden=true;
    function showgetat(){
        getat.hidden=false;
    }
    let score=0;
    let end
    let countdown = 10;
    let testCandidateInp
    let testCandidate = 'Loba'
    nextprev.innerHTML='';
    maindisapear.innerHTML='';

    function Enter() {
    testCandidateInp=document.getElementById('CandName').value;
        if (testCandidate==testCandidateInp) {
            // alert('ope o')
            // display()
            maindisapear.innerHTML=`
                <div id="disapear"><button onclick="start()" class="btn btn-primary">Start</button></div>`

        disapear.innerHTML=`<button onclick="start()" class="btn btn-primary">Start</button>`
        ForCandidate.innerHTML=''
    head.innerHTML=testCandidateInp+"'s";
        }
        else if (testCandidate!=testCandidateInp) {
        alert('Pls check and Enter correct Candidate name')
        } 
        console.log(testCandidateInp);
    }

    function retake(){
        disp2.innerHTML='';
        disp.innerHTML=''
        maindisapear.innerHTML=`
                <div id="disapear"><button onclick="start()" class="btn btn-primary">Start</button></div>`
            showscore2.innerHTML='';
            // disapear.innerHTML=`<button onclick="start()" class="btn btn-primary">Start</button>`
        ForCandidate.innerHTML=''
        // start()  
      
    }
    
    questsandops = [
        {q: `<p class='text-left'> <span>1.</span> <i>Fill in the blank spaces in the following sentences making use of the best of the five option:</i>
                The telephone .... in the nineteenth century and is now used in most countries in the world</p>`, 
        op:['had_been_invented', 'was_invented', 'would_have_been_invented', 'has_been_invented'],
        ans:'had_been_invented',
        chosenAns:''
    },
    {
        q:'<span>2.</span> This class __________students and teachers', 
        op:['comprise', 'comprises', 'comprise of', 'comprises of'],
        ans:'comprises',
        chosenAns:''
    },
    {q: `<p class='text-left'> <span>3.</span> Before I arrived, the choir _______ the hymn</p>`, 
        op:['have_sing', 'has_sing', 'had_sung', 'have_sang'],
        ans:'had_sung',
        chosenAns:''
    },
    {q: `<p class='text-left'> <span>4.</span> The soldier _________ his gun on the wall after the armed robber______</p>`, 
        op:['hang/has_been_hung', 'hung/had_been_hanged', 'hanged/has_been_hanged', 'hung/has_been_hunged'],
        ans:'hung/had_been_hanged',
        chosenAns:''
    },
    {q: `<p class='text-left'> <span>5.</span> Thank you for the __________ of presenting my paper.</p>`, 
        op:['privelege', 'priveledge', 'privilege', 'preveledge'],
        ans:'privilege',
        chosenAns:''
    }
    ]
    let index = 0

    
    function display(params) {
        // let a = questsandops[0].q
        // document.getElementById('disp').innerHTML = `<h3>${a}</h3>`
        disp2.innerHTML = `<p>${index+1} of ${questsandops.length}</p>`
        document.getElementById('disp').innerHTML = `${questsandops[index].q}`
        questsandops[index].op.forEach(function (e, i) {
            disp.innerHTML +=`<p class='text-left'><input type='radio' value=${e} class='myans' name='gender'>${e}</p>`
            document.querySelectorAll('.myans').forEach((box)=>{
                box.addEventListener('click', answer)
                // if (box.value==questsandops[index].chosenAns) {
                //     box.checked=true;
                // }
            })
        })
        maindisapear.innerHTML=`<button onclick="submit()" class="btn btn-success w-25">Submit</button>
                <div id="disapear2"><button onclick="retake()" class="btn btn-secondary">Retake</button></div>
                <div id="disapear"><button onclick="start()" class="btn btn-primary">Start</button></div>`

        disapear.innerHTML=`<button onclick="start()" class="btn btn-primary">Start</button>`
        ForCandidate.innerHTML=''
        nextprev.innerHTML=`<button class="btn btn-outline-danger" onclick="control('prev')"><</button>
                <button class="btn btn-outline-danger"onclick="control('next')">></button>`

        // document.getElementById('disp').innerHTML = 
        

        // for (let i = 0; i < questsandops[index].op.length; i++) {
        //     disp.innerHTML+=`<p class='mt-4 ml-3'><input type='radio'>${questsandops[index].op[i]}</p>`
        // }
    }

    function answer(params){
    //    document.querySelectorAll('.myans').forEach(function(max){
    //    max.checked=false;
    //    })
    
       params.target.checked=true;
       questsandops[index].chosenAns=params.target.value;
       console.log(questsandops[index].chosenAns);

       if (questsandops[index].chosenAns==questsandops[index].ans) {
        console.log("correct");
        score++;
       }
    //    if (params.target.checked=false) {
    //        return control('next') 
    //        console.log('condition works');
    //    }
       else if(questsandops[index].chosenAns!=questsandops[index].ans){
           console.log("error");
       }
    }

    function control(params) {
        if (params == 'next') {
            if (questsandops[index + 1]) {
               index++
               console.log(index+'this is inex');
               display() 
               console.log(score);
            }
        }
        else{
            if (questsandops[index - 1]) {
                index--
               console.log(index);
                display()
            }
        }

    }

    function submit() {
        // console.log(score);
        // questsandops.forEach(function(params) {
        //     if (questsandops.ans == chosenAns.value) {
        //         score++
        //     }
        //     // else{score = 0}
        // })
        console.log(`your score=${score} of ${questsandops.length}`);
            document.getElementById('showscore').innerHTML = ` ${testCandidateInp} you score= ${score} / ${questsandops.length}`
            clearInterval(end);
            disapear2.innerHTML=`<button onclick="retake()" class="btn btn-secondary">Retake</button>`

        // alert(score+'/'+questsandops.length)
    }

    
    function start() {
        display()
        showscore()
        show() 
        disapear.innerHTML='' 
        disapear2.innerHTML=''
    }

    function show() {
        end=setInterval(function () {
            countdown--;
            document.getElementById('showscore').innerHTML = 'You have '+countdown+'s left';

            if (countdown <= 1) {
            clearInterval(end)
            disapear2.innerHTML=`<button onclick="retake()" class="btn btn-secondary">Retake</button>`
        disp.innerHTML='';
        nextprev.innerHTML='';
            console.log('done!!!')
        }
        }, 1000);
    }
    // setTimeout(submit(), 5000)
   

    function showscore() {
        setTimeout(function lol(){
            submit()
        }, 10000)
    }
    
    
    // let arrs = document.querySelectorAll('.mybox');''
    // arrs.forEach(function(params) {
    //     params.addEventListener('click', function(event) {
    //         console.log(event.target.value);
    //     })
    // })
    // display()
</script>